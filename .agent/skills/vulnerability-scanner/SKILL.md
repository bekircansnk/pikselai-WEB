---
name: vulnerability-scanner
description: Ä°leri dÃ¼zey gÃ¼venlik aÃ§Ä±ÄŸÄ± analizi prensipleri. OWASP 2025, Tedarik Zinciri GÃ¼venliÄŸi, saldÄ±rÄ± yÃ¼zeyi haritalama, risk Ã¶nceliklendirme.
allowed-tools: Read, Glob, Grep, Bash
---

# GÃ¼venlik AÃ§Ä±ÄŸÄ± TarayÄ±cÄ±sÄ± (Vulnerability Scanner)

> Bir saldÄ±rgan gibi dÃ¼ÅŸÃ¼n, bir uzman gibi savun. 2025 tehdit manzarasÄ± farkÄ±ndalÄ±ÄŸÄ±.

## ğŸ”§ Ã‡alÄ±ÅŸma ZamanÄ± Scriptleri

**Otomatik doÄŸrulama iÃ§in bunlarÄ± Ã§alÄ±ÅŸtÄ±r:**

| Script | AmaÃ§ | KullanÄ±m |
|--------|------|----------|
| `scripts/security_scan.py` | Uygulanan gÃ¼venlik ilkelerini doÄŸrula | `python scripts/security_scan.py <proje_yolu>` |

## ğŸ“‹ Referans DosyalarÄ±

| Dosya | AmaÃ§ |
|-------|------|
| [checklists.md](checklists.md) | OWASP Top 10, Kimlik DoÄŸrulama, API, Veri koruma kontrol listeleri |

---

## 1. GÃ¼venlik UzmanÄ± Zihniyeti

### Temel Prensipler

| Prensip | Uygulama |
|---------|----------|
| **Ä°hlal OlduÄŸunu Varsay** | SaldÄ±rgan zaten iÃ§erideymiÅŸ gibi tasarla |
| **SÄ±fÄ±r GÃ¼ven (Zero Trust)** | Asla gÃ¼venme, her zaman doÄŸrula |
| **Derinlemesine Savunma** | Ã‡oklu katmanlar, tek nokta yok |
| **En Az AyrÄ±calÄ±k** | Sadece gerekli minimum eriÅŸim |
| **GÃ¼venli BaÅŸarÄ±sÄ±zlÄ±k** | Hata durumunda, eriÅŸimi reddet |

### Tehdit Modelleme SorularÄ±

Taramadan Ã¶nce sor:
1. Neyi koruyoruz? (VarlÄ±klar)
2. Kim saldÄ±rÄ±r? (Tehdit aktÃ¶rleri)
3. NasÄ±l saldÄ±rÄ±rlar? (SaldÄ±rÄ± vektÃ¶rleri)
4. Etkisi ne olur? (Ä°ÅŸ riski)

---

## 2. OWASP Top 10:2025

### Risk Kategorileri

| SÄ±ra | Kategori | DÃ¼ÅŸÃ¼nÃ¼lecekler |
|------|----------|----------------|
| **A01** | Bozuk EriÅŸim KontrolÃ¼ | Kim neye eriÅŸebilir? IDOR, SSRF |
| **A02** | GÃ¼venlik YanlÄ±ÅŸ YapÄ±landÄ±rmasÄ± | VarsayÄ±lanlar, baÅŸlÄ±klar, aÃ§Ä±k servisler |
| **A03** | YazÄ±lÄ±m Tedarik Zinciri ğŸ†• | BaÄŸÄ±mlÄ±lÄ±klar, CI/CD, derleme bÃ¼tÃ¼nlÃ¼ÄŸÃ¼ |
| **A04** | Kriptografik Hatalar | ZayÄ±f kripto, aÃ§Ä±k sÄ±rlar |
| **A05** | Enjeksiyon | KullanÄ±cÄ± girdisi â†’ sistem komutlarÄ± |
| **A06** | GÃ¼vensiz TasarÄ±m | Kusurlu mimari |
| **A07** | Kimlik DoÄŸrulama HatalarÄ± | Oturum, kimlik bilgisi yÃ¶netimi |
| **A08** | BÃ¼tÃ¼nlÃ¼k HatalarÄ± | Ä°mzasÄ±z gÃ¼ncellemeler, kurcalanmÄ±ÅŸ veriler |
| **A09** | Loglama & Uyarma | KÃ¶r noktalar, izleme yok |
| **A10** | Ä°stisnai Durumlar ğŸ†• | Hata yÃ¶netimi, fail-open durumlar |

### 2025 Ã–nemli DeÄŸiÅŸiklikler

```
2021 â†’ 2025 GeÃ§iÅŸleri:
â”œâ”€â”€ SSRF, A01 (EriÅŸim KontrolÃ¼) iÃ§ine birleÅŸtirildi
â”œâ”€â”€ A02 yÃ¼kseltildi (Bulut/Konteyner yapÄ±landÄ±rmalarÄ±)
â”œâ”€â”€ A03 YENÄ°: Tedarik Zinciri (ana odak)
â”œâ”€â”€ A10 YENÄ°: Ä°stisnai Durumlar
â””â”€â”€ Odak deÄŸiÅŸimi: KÃ¶k nedenler > Semptomlar
```

---

## 3. Tedarik Zinciri GÃ¼venliÄŸi (A03)

### SaldÄ±rÄ± YÃ¼zeyi

| VektÃ¶r | Risk | Sorulacak Soru |
|--------|------|----------------|
| **BaÄŸÄ±mlÄ±lÄ±klar** | KÃ¶tÃ¼ amaÃ§lÄ± paketler | Yeni baÄŸÄ±mlÄ±lÄ±klarÄ± denetliyor muyuz? |
| **Kilit dosyalarÄ±** | BÃ¼tÃ¼nlÃ¼k saldÄ±rÄ±larÄ± | Commit ediliyorlar mÄ±? |
| **Derleme boru hattÄ±** | CI/CD ele geÃ§irme | Kim deÄŸiÅŸtirebilir? |
| **KayÄ±t defteri** | Typosquatting | DoÄŸrulanmÄ±ÅŸ kaynaklar? |

### Savunma Prensipleri

- Paket bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ doÄŸrula (checksums)
- SÃ¼rÃ¼mleri sabitle (pin), gÃ¼ncellemeleri denetle
- Kritik baÄŸÄ±mlÄ±lÄ±klar iÃ§in Ã¶zel kayÄ±t defterleri kullan
- Eserleri (artifacts) imzala ve doÄŸrula

---

## 4. SaldÄ±rÄ± YÃ¼zeyi Haritalama

### Haritalanacaklar

| Kategori | Ã–ÄŸeler |
|----------|--------|
| **GiriÅŸ NoktalarÄ±** | API'ler, formlar, dosya yÃ¼klemeleri |
| **Veri AkÄ±ÅŸlarÄ±** | Girdi â†’ Ä°ÅŸlem â†’ Ã‡Ä±ktÄ± |
| **GÃ¼ven SÄ±nÄ±rlarÄ±** | Auth/authz nerede kontrol ediliyor |
| **VarlÄ±klar** | SÄ±rlar, PII, iÅŸ verileri |

### Ã–nceliklendirme Matrisi

```
Risk = OlasÄ±lÄ±k Ã— Etki

YÃ¼ksek Etki + YÃ¼ksek OlasÄ±lÄ±k â†’ KRÄ°TÄ°K
YÃ¼ksek Etki + DÃ¼ÅŸÃ¼k OlasÄ±lÄ±k  â†’ YÃœKSEK
DÃ¼ÅŸÃ¼k Etki + YÃ¼ksek OlasÄ±lÄ±k  â†’ ORTA
DÃ¼ÅŸÃ¼k Etki + DÃ¼ÅŸÃ¼k OlasÄ±lÄ±k   â†’ DÃœÅÃœK
```

---

## 5. Risk Ã–nceliklendirme

### CVSS + BaÄŸlam

| FaktÃ¶r | AÄŸÄ±rlÄ±k | Soru |
|--------|---------|------|
| **CVSS Skoru** | Temel ciddiyet | AÃ§Ä±k ne kadar ciddi? |
| **EPSS Skoru** | Ä°stismar olasÄ±lÄ±ÄŸÄ± | Ä°stismar ediliyor mu? |
| **VarlÄ±k DeÄŸeri** | Ä°ÅŸ baÄŸlamÄ± | Ne risk altÄ±nda? |
| **Maruziyet** | SaldÄ±rÄ± yÃ¼zeyi | Ä°nternete aÃ§Ä±k mÄ±? |

### Ã–nceliklendirme Karar AÄŸacÄ±

```
Aktif olarak istismar ediliyor mu (EPSS >0.5)?
â”œâ”€â”€ EVET â†’ KRÄ°TÄ°K: Acil eylem
â””â”€â”€ HAYIR â†’ CVSS kontrol et
            â”œâ”€â”€ CVSS â‰¥9.0 â†’ YÃœKSEK
            â”œâ”€â”€ CVSS 7.0-8.9 â†’ VarlÄ±k deÄŸerini dÃ¼ÅŸÃ¼n
            â””â”€â”€ CVSS <7.0 â†’ Daha sonrasÄ± iÃ§in planla
```

---

## 6. Ä°stisnai Durumlar (A10 - Yeni)

### Fail-Open vs Fail-Closed

| Senaryo | Fail-Open (KÃ–TÃœ) | Fail-Closed (Ä°YÄ°) |
|---------|------------------|-------------------|
| Auth hatasÄ± | EriÅŸime izin ver | EriÅŸimi reddet |
| AyrÄ±ÅŸtÄ±rma baÅŸarÄ±sÄ±z | Girdiyi kabul et | Girdiyi reddet |
| Zaman aÅŸÄ±mÄ± | Sonsuza kadar dene | SÄ±nÄ±rla + iptal et |

### Kontrol Edilecekler

- Her ÅŸeyi yakalayan (catch-all) ve gÃ¶rmezden gelen istisna iÅŸleyicileri
- GÃ¼venlik operasyonlarÄ±nda eksik hata yÃ¶netimi
- Auth/authz iÃ§inde yarÄ±ÅŸ durumlarÄ± (race conditions)
- Kaynak tÃ¼kenmesi senaryolarÄ±

---

## 7. Tarama Metodolojisi

### AÅŸama TabanlÄ± YaklaÅŸÄ±m

```
1. KEÅÄ°F (RECONNAISSANCE)
   â””â”€â”€ Hedefi anla
       â”œâ”€â”€ Teknoloji yÄ±ÄŸÄ±nÄ±
       â”œâ”€â”€ GiriÅŸ noktalarÄ±
       â””â”€â”€ Veri akÄ±ÅŸlarÄ±

2. BULMA (DISCOVERY)
   â””â”€â”€ Potansiyel sorunlarÄ± belirle
       â”œâ”€â”€ YapÄ±landÄ±rma incelemesi
       â”œâ”€â”€ BaÄŸÄ±mlÄ±lÄ±k analizi
       â””â”€â”€ Kod deseni aramasÄ±

3. ANALÄ°Z (ANALYSIS)
   â””â”€â”€ DoÄŸrula ve Ã¶nceliklendir
       â”œâ”€â”€ YanlÄ±ÅŸ pozitif eliminasyonu
       â”œâ”€â”€ Risk puanlama
       â””â”€â”€ SaldÄ±rÄ± zinciri haritalama

4. RAPORLAMA (REPORTING)
   â””â”€â”€ Eyleme geÃ§irilebilir bulgular
       â”œâ”€â”€ Net yeniden Ã¼retme adÄ±mlarÄ±
       â”œâ”€â”€ Ä°ÅŸ etkisi
       â””â”€â”€ Ä°yileÅŸtirme rehberliÄŸi
```

---

## 8. Kod Deseni Analizi

### YÃ¼ksek Riskli Desenler

| Desen | Risk | Ara |
|-------|------|-----|
| **Sorgularda dize birleÅŸtirme** | Enjeksiyon | `"SELECT * FROM " + user_input` |
| **Dinamik kod yÃ¼rÃ¼tme** | RCE | `eval()`, `exec()`, `Function()` |
| **GÃ¼vensiz serileÅŸtirme** | RCE | `pickle.loads()`, `unserialize()` |
| **Yol manipÃ¼lasyonu** | Dizin geÃ§iÅŸi (Traversal) | Dosya yollarÄ±nda kullanÄ±cÄ± verisi |
| **Devre dÄ±ÅŸÄ± gÃ¼venlik** | Ã‡eÅŸitli | `verify=False`, `--insecure` |

### SÄ±r Desenleri

| Tip | GÃ¶stergeler |
|-----|-------------|
| API AnahtarlarÄ± | `api_key`, `apikey`, yÃ¼ksek entropi |
| Tokenlar | `token`, `bearer`, `jwt` |
| Kimlik Bilgileri | `password`, `secret`, `key` |
| Bulut | `AWS_`, `AZURE_`, `GCP_` Ã¶nekleri |

---

## 9. Bulut GÃ¼venliÄŸi HususlarÄ±

### PaylaÅŸÄ±lan Sorumluluk

| Katman | Sen | SaÄŸlayÄ±cÄ± |
|--------|-----|-----------|
| Veri | âœ… | âŒ |
| Uygulama | âœ… | âŒ |
| OS/Runtime | Duruma gÃ¶re | Duruma gÃ¶re |
| AltyapÄ± | âŒ | âœ… |

### Buluta Ã–zgÃ¼ Kontroller

- IAM: En az ayrÄ±calÄ±k uygulandÄ± mÄ±?
- Depolama: Herkese aÃ§Ä±k kovalar (buckets) var mÄ±?
- AÄŸ: GÃ¼venlik gruplarÄ± sÄ±kÄ±laÅŸtÄ±rÄ±ldÄ± mÄ±?
- SÄ±rlar: Secrets manager kullanÄ±lÄ±yor mu?

---

## 10. Anti-Desenler

| âŒ Yapma | âœ… Yap |
|----------|-------|
| Anlamadan tara | Ã–nce saldÄ±rÄ± yÃ¼zeyini haritala |
| Her CVE iÃ§in alarm ver | Ä°stismar edilebilirlik + varlÄ±k bazlÄ± Ã¶nceliklendir |
| YanlÄ±ÅŸ pozitifleri gÃ¶rmezden gel | DoÄŸrulanmÄ±ÅŸ temel Ã§izgiyi koru |
| Sadece semptomlarÄ± dÃ¼zelt | KÃ¶k nedenleri ele al |
| DaÄŸÄ±tÄ±mdan Ã¶nce bir kez tara | SÃ¼rekli tarama |
| ÃœÃ§Ã¼ncÃ¼ taraf baÄŸÄ±mlÄ±lÄ±klara kÃ¶rÃ¼ kÃ¶rÃ¼ne gÃ¼ven | BÃ¼tÃ¼nlÃ¼ÄŸÃ¼ doÄŸrula, kodu denetle |

---

## 11. Raporlama Prensipleri

### Bulgu YapÄ±sÄ±

Her bulgu ÅŸunlarÄ± cevaplamalÄ±dÄ±r:
1. **Ne?** - Net gÃ¼venlik aÃ§Ä±ÄŸÄ± aÃ§Ä±klamasÄ±
2. **Nerede?** - Kesin konum (dosya, satÄ±r, uÃ§ nokta)
3. **Neden?** - KÃ¶k neden aÃ§Ä±klamasÄ±
4. **Etki?** - Ä°ÅŸ sonucu
5. **NasÄ±l dÃ¼zeltilir?** - Spesifik iyileÅŸtirme

### Ciddiyet SÄ±nÄ±flandÄ±rmasÄ±

| Ciddiyet | Kriterler |
|----------|-----------|
| **Kritik** | RCE, auth bypass, toplu veri ifÅŸasÄ± |
| **YÃ¼ksek** | Veri ifÅŸasÄ±, ayrÄ±calÄ±k yÃ¼kseltme |
| **Orta** | SÄ±nÄ±rlÄ± kapsam, koÅŸullar gerektirir |
| **DÃ¼ÅŸÃ¼k** | Bilgilendirici, en iyi uygulama |

---

> **Unutma:** GÃ¼venlik aÃ§Ä±ÄŸÄ± taramasÄ± sorunlarÄ± bulur. Uzman dÃ¼ÅŸÃ¼ncesi neyin Ã¶nemli olduÄŸunu Ã¶nceliklendirir. Her zaman sor: "Bir saldÄ±rgan bununla ne yapardÄ±?"
